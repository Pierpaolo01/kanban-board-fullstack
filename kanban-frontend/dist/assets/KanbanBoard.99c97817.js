import{d as y,o as l,c as i,e as n,t as r,n as V,r as C,C as B,F as h,q as _,g as v,y as S,i as b,b as f,w,f as D,D as I,z as E,A as K}from"./index.a00f9cf5.js";import{c as M,K as x,I as N,_ as z}from"./KanbanModalCreateUpdateTask.vue_vue_type_script_setup_true_lang.3f104021.js";import{_ as $}from"./KanbanButton.39b4a9b1.js";const U={class:"flex items-center space-x-4 bg-light-mode p-3 rounded hover:bg-purple/25 dark:bg-dark-gray dark:hover:bg-purple/25"},A=["checked"],F=y({__name:"KanbanSubtask",props:{isChecked:{type:Boolean},text:null},emits:["toggle"],setup(c,{emit:k}){return(e,s)=>(l(),i("div",U,[n("input",{class:"h-4 w-4",type:"checkbox",checked:c.isChecked,onInput:s[0]||(s[0]=m=>k("toggle"))},null,40,A),n("span",{class:V(["text-sm text-black dark:text-white",c.isChecked?"line-through":""])},r(c.text),3)]))}}),R={class:"space-y-6"},q={class:"text-lg"},H={class:"text-p"},L={class:"text-dark-lines text-sm dark:text-white mb-4"},j=y({__name:"KanbanViewDetailedTask",props:{modelValue:null},emits:["refreshBoard"],setup(c,{emit:k}){const s=C({task:M(c.modelValue)});return B(()=>s.task.subtasks,async()=>{try{await x.updateSubtask(s.task.id,s.task.subtasks),k("refreshBoard")}catch(m){console.log(m)}},{deep:!0}),(m,T)=>(l(),i("div",R,[n("h1",q,r(c.modelValue.title),1),n("p",H,r(c.modelValue.description),1),n("div",null,[n("label",L," Subtasks "+r(s.task.subtasks.filter(u=>u.isDone===!0).length)+" of "+r(s.task.subtasks.length),1),(l(!0),i(h,null,_(s.task.subtasks,(u,g)=>(l(),v(F,{key:g,class:"my-2",text:u.name,"is-checked":u.isDone,onToggle:o=>u.isDone=!u.isDone},null,8,["text","is-checked","onToggle"]))),128))])]))}}),G={class:"overflow-x-auto"},J={key:0,class:"flex space-x-12 text-gray-medium max-w-[0px] pb-6"},O=["onDrop"],P={class:"w-72 space-y-4"},Q={class:"flex items-center mb-6"},W=["onDragstart"],X=["onClick"],Y=["onClick"],Z={class:"text-sm"},ae=y({__name:"KanbanBoard",setup(c){const k=K(),e=C({board:null,detailedTask:null,editTask:null}),s=async()=>{try{const o=await x.getBoard(String(k.params.boardId));e.board=o.data.data}catch(o){console.log(o)}},m=(o,t)=>{o.dataTransfer.dropEffect="move",o.dataTransfer.effectAllowed="move",o.dataTransfer.setData("taskId",String(t.id))},T=(o,t)=>{const a=o.dataTransfer.getData("taskId");u(a,t)},u=async(o,t)=>{try{await x.moveTask(e.board.id,o,t),await s()}catch(a){console.log(a)}},g=()=>`#${Math.floor(Math.random()*16777215).toString(16).padEnd(6,"0")}`;return S(async()=>s()),(o,t)=>(l(),i(h,null,[n("div",G,[e.board?(l(),i("div",J,[(l(!0),i(h,null,_(e.board.Columns,a=>(l(),i("div",{key:a.id,onDrop:d=>T(d,a.id),onDragenter:t[0]||(t[0]=D(()=>{},["prevent"])),onDragover:t[1]||(t[1]=D(()=>{},["prevent"]))},[n("div",P,[n("h1",Q,[n("span",{class:"w-4 h-4 rounded-full mr-2",style:I({background:g()})},null,4),E(" "+r(a.name)+" ("+r(a.Tasks.length)+") ",1)]),(l(!0),i(h,null,_(a.Tasks,d=>(l(),i("div",{class:"p-6 bg-white rounded-lg shadow-lg relative",key:d.id,draggable:"true",onDragstart:p=>m(p,d)},[n("div",{class:"absolute top-0 right-0 pt-4 pr-4 cursor-pointer",onClick:p=>e.editTask=d},[f(N,{class:"w-4 h-4"})],8,X),n("p",{class:"text-md text-black mb-2 cursor-pointer w-fit",onClick:p=>e.detailedTask=d},r(d.title),9,Y),n("span",Z,r(d.subtasks.filter(p=>p.isDone===!0).length)+"/"+r(d.subtasks.length)+" of subtasks ",1)],40,W))),128))])],40,O))),128))])):b("",!0)]),f($,{"model-value":!!e.detailedTask,"onUpdate:modelValue":t[3]||(t[3]=a=>e.detailedTask=null),"has-click-away":!0},{default:w(()=>[e.detailedTask?(l(),v(j,{key:0,modelValue:e.detailedTask,"onUpdate:modelValue":t[2]||(t[2]=a=>e.detailedTask=a),onRefreshBoard:s},null,8,["modelValue"])):b("",!0)]),_:1},8,["model-value"]),f($,{"model-value":!!e.editTask,"onUpdate:modelValue":t[5]||(t[5]=a=>e.editTask=null),"has-click-away":!0},{default:w(()=>[e.editTask&&e.board?(l(),v(z,{key:0,type:"update",task:e.editTask,board:e.board,onClose:t[4]||(t[4]=a=>{e.editTask=null,s()})},null,8,["task","board"])):b("",!0)]),_:1},8,["model-value"])],64))}});export{ae as default};
